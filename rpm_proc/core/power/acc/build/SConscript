import os

Import('env')
env = env.Clone()
#default vipertooth support using Starlord target specific files   
if env['MSM_ID'] in ['405']:
   env['MSM_ID'] = '660'

supported_targets = ['8996', '8998', '660', 'nicobar']
if env['MSM_ID'] not in supported_targets:
    env.PrintWarning('Bailing from ACC scripts; no support for build targets other than %s' % supported_targets)
    Return()

SRCPATH = "../src"
env.VariantDir('${BUILDPATH}', SRCPATH, duplicate=0)

env.Append(CFLAGS = '${ARMCC_STDC99_CMD}')
env.Append(CPPPATH = '../src')

CBSP_API = [
   'POWER',
   'SYSTEMDRIVERS',
   'PMIC',
   'DAL',
   'SERVICES',
   'DEBUGTRACE',
   'BOOT',
   'POWER_UTILS'
]

env.RequirePublicApi(CBSP_API)
env.RequireRestrictedApi(CBSP_API)

#-------------------------------------------------------------------------------
# Generate QFPROM PVS HWIO definitions
#-------------------------------------------------------------------------------
if env.has_key('HWIO_IMAGE'):
    if env['MSM_ID'] in ['8996', '8998']:
        env.AddHWIOFile('HWIO', [
            {
                'filename': '${INC_ROOT}/core/power/acc/src/${MSM_ID}/tcsr_hwio_acc.h',
                'modules': ['TCSR_TCSR_REGS'],
                'output-offsets': False,
                'header':
                    '#include "msmhwiobase.h"\n\n'
            }
        ])

ACC_SOURCES = [
	'${BUILDPATH}/acc.c',
    '${BUILDPATH}/${MSM_ID}/acc_config.c',
]

env.AddLibrary(['CORE_RPM'], '${BUILDPATH}/acc.lib', ACC_SOURCES)

